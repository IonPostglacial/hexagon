<!DOCTYPE HTML>
<html>
  <head>
    <title>Playing with hexagons</title>
    <link href="css/style.css" rel="stylesheet">
    <link href="css/font-awesome.min.css" rel="stylesheet">
    <script src="lib/react.js"></script>
    <script src="lib/react-dom.js"></script>
    <script src="lib/require.js"></script>
    <script>
      requirejs(["js/mapeditor", "js/renderer", "js/download", "js/hselectbox", "js/tile", "lib/hexmap"],
        (Editor, Renderer, Download, HSelectBox, Tile, HexMap) => {
        "use strict";

        const GRID = {width: 14, height:12, radius: 32, data: new HexMap(14, 12, 0)};

        Renderer.init(GRID);
        Editor.init(GRID);
        Download.init(GRID);
        ReactDOM.render(
          React.createElement(HSelectBox, {onChange: e => { Editor.selectedTileType = e.value }, data: Tile.types}),
          document.getElementById('editor')
        );
        Editor.ontiletypechange = e => {
         GRID.data.set(e.position, e.tileType);
         Renderer.drawBackground();
        };
        Editor.onselectedtilechange = e => {
         Renderer.setLastStep(e.coordinates);
         Renderer.drawScene();
        };
        Download.onscenechange = e => Renderer.drawBackground();
      });
    </script>
  </head>
  <body>
    <!-- Renderer -->
    <div id="layers" class="layers">
      <canvas class="layer" id="background">
        This page is useless without canvas.
      </canvas>
      <canvas class="layer" id="scene">
        This page is useless without canvas.
      </canvas>
    </div>
    <!-- Editor -->
    <div id="editor"></div>
    <ul class="centered tool-box">
      <li class="tool">
        <table id="coord-hex" class="tool numerical gauge">
          <caption>Hex Coordinates</caption>
          <tr><th>x</th><td>0</td><th>y</th><td>0</td></tr>
        </table>
      </li>
      <li class="tool">
        <table id="coord-mouse" class="tool numerical gauge">
          <caption>Pix Coordinates</caption>
          <tr><th>x</th><td>0</td><th>y</th><td>0</td></tr>
        </table>
      </li>
    </ul>
    <!-- Download -->
    <ul class="centered tool-box">
      <li class="tool">
        <a class="btn" id="download-scene" href="#" download><i class="fa fa-pull-left fa-download fa-lg"></i>Download current stage</a>
      </li>
      <li class="tool">
        <a class="btn" id="upload-scene" href="#"><i class="fa fa-pull-left fa-upload fa-lg"></i>Upload a stage</a>
      </li>
      <li class="tool">
        <a class="btn" id="save-scene" href="#"><i class="fa fa-pull-left fa-floppy-o fa-lg"></i>Save current stage</a>
      </li>
      <li class="tool">
        <a class="btn" id="load-scene" href="#"><i class="fa fa-pull-left fa-folder-open-o fa-lg"></i>Load stage</a>
      </li>
    </ul>
    <form id="hidden-form">
      <input type="file" id="uploaded" />
    </form>
  </body>
</html>
